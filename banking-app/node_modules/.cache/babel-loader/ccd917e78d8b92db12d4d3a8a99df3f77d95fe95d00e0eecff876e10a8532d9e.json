{"ast":null,"code":"import _toConsumableArray from\"C:/Users/nghia/Desktop/Learning Web Coding/banking-application/banking-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/nghia/Desktop/Learning Web Coding/banking-application/banking-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import AuthContext from\"./auth-context\";import{jsx as _jsx}from\"react/jsx-runtime\";var AuthProvider=function AuthProvider(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),currentLogin=_useState2[0],setCurrentLogin=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),accounts=_useState4[0],setAccounts=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoggedIn=_useState6[0],setIsLoggedIn=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),triggerFetched=_useState8[0],setTriggerFetched=_useState8[1];useEffect(function(){console.log(\"use effect ran\");fetch(\"http://localhost:1337/api/accounts\").then(function(res){return res.json();}).then(function(data){var accountsFetched=data.data;setAccounts(accountsFetched);});},[triggerFetched]);var signupHandler=function signupHandler(firstName,lastName,email,password){var requestOptions={method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({data:{firstName:firstName,lastName:lastName,email:email,password:password,balance:0,transaction:[]}})};fetch(\"http://localhost:1337/api/accounts/\",requestOptions).then(function(res){return res.json();}).then(function(res){setTriggerFetched(function(prevState){return!prevState;});});};var loginHandler=function loginHandler(email,password){var isFound=false;if(accounts.length===0)isFound=false;for(var i=0;i<accounts.length;i++){if(accounts[i].attributes.email===email&&accounts[i].attributes.password===password){setIsLoggedIn(true);setCurrentLogin(accounts[i]);isFound=true;break;}}if(!isFound)alert(\"Account not found!\");};var logoutHandler=function logoutHandler(){setIsLoggedIn(false);setCurrentLogin({});};var deposit=function deposit(amount,activity){var newBalance=currentLogin.attributes.balance+parseInt(amount);var requestOptions={method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({data:{balance:newBalance,transaction:[activity].concat(_toConsumableArray(currentLogin.attributes.transaction))}})};fetch(\"http://localhost:1337/api/accounts/\".concat(currentLogin.id),requestOptions).then(function(res){return res.json();}).then(function(data){setCurrentLogin(data.data);setTriggerFetched(function(prevState){return!prevState;});});};var withdrawal=function withdrawal(amount,activity){var newBalance=currentLogin.attributes.balance-parseInt(amount);var requestOptions={method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({data:{balance:newBalance,transaction:[activity].concat(_toConsumableArray(currentLogin.attributes.transaction))}})};fetch(\"http://localhost:1337/api/accounts/\".concat(currentLogin.id),requestOptions).then(function(res){return res.json();}).then(function(data){setCurrentLogin(data.data);setTriggerFetched(function(prevState){return!prevState;});});};var authContext={users:accounts,isLoggedIn:isLoggedIn,currentLogin:currentLogin,onLogout:logoutHandler,onLogin:loginHandler,onSignup:signupHandler,onDeposit:deposit,onWithdrawal:withdrawal};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:authContext,children:props.children});};export default AuthProvider;","map":{"version":3,"names":["useEffect","useState","AuthContext","jsx","_jsx","AuthProvider","props","_useState","_useState2","_slicedToArray","currentLogin","setCurrentLogin","_useState3","_useState4","accounts","setAccounts","_useState5","_useState6","isLoggedIn","setIsLoggedIn","_useState7","_useState8","triggerFetched","setTriggerFetched","console","log","fetch","then","res","json","data","accountsFetched","signupHandler","firstName","lastName","email","password","requestOptions","method","headers","body","JSON","stringify","balance","transaction","prevState","loginHandler","isFound","length","i","attributes","alert","logoutHandler","deposit","amount","activity","newBalance","parseInt","concat","_toConsumableArray","id","withdrawal","authContext","users","onLogout","onLogin","onSignup","onDeposit","onWithdrawal","Provider","value","children"],"sources":["C:/Users/nghia/Desktop/Learning Web Coding/banking-application/banking-app/src/store/AuthProvider.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport AuthContext from \"./auth-context\";\r\n\r\nconst AuthProvider = (props) => {\r\n  const [currentLogin, setCurrentLogin] = useState({});\r\n  const [accounts, setAccounts] = useState([]);\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  const [triggerFetched, setTriggerFetched] = useState(false);\r\n\r\n  useEffect(() => {\r\n    console.log(\"use effect ran\");\r\n    fetch(\"http://localhost:1337/api/accounts\")\r\n      .then((res) => {\r\n        return res.json();\r\n      })\r\n      .then((data) => {\r\n        const accountsFetched = data.data;\r\n        setAccounts(accountsFetched);\r\n      });\r\n  }, [triggerFetched]);\r\n\r\n  const signupHandler = (firstName, lastName, email, password) => {\r\n    const requestOptions = {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        data: {\r\n          firstName: firstName,\r\n          lastName: lastName,\r\n          email: email,\r\n          password: password,\r\n          balance: 0,\r\n          transaction: [],\r\n        },\r\n      }),\r\n    };\r\n\r\n    fetch(\"http://localhost:1337/api/accounts/\", requestOptions)\r\n      .then((res) => res.json())\r\n      .then((res) => {\r\n        setTriggerFetched((prevState) => !prevState);\r\n      });\r\n  };\r\n\r\n  const loginHandler = (email, password) => {\r\n    let isFound = false;\r\n    if (accounts.length === 0) isFound = false;\r\n\r\n    for (let i = 0; i < accounts.length; i++) {\r\n      if (\r\n        accounts[i].attributes.email === email &&\r\n        accounts[i].attributes.password === password\r\n      ) {\r\n        setIsLoggedIn(true);\r\n        setCurrentLogin(accounts[i]);\r\n        isFound = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!isFound) alert(\"Account not found!\");\r\n  };\r\n\r\n  const logoutHandler = () => {\r\n    setIsLoggedIn(false);\r\n    setCurrentLogin({});\r\n  };\r\n\r\n  const deposit = (amount, activity) => {\r\n    const newBalance = currentLogin.attributes.balance + parseInt(amount);\r\n    const requestOptions = {\r\n      method: \"PUT\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        data: {\r\n          balance: newBalance,\r\n          transaction: [activity, ...currentLogin.attributes.transaction],\r\n        },\r\n      }),\r\n    };\r\n\r\n    fetch(\r\n      `http://localhost:1337/api/accounts/${currentLogin.id}`,\r\n      requestOptions\r\n    )\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setCurrentLogin(data.data);\r\n        setTriggerFetched((prevState) => !prevState);\r\n      });\r\n  };\r\n\r\n  const withdrawal = (amount, activity) => {\r\n    const newBalance = currentLogin.attributes.balance - parseInt(amount);\r\n    const requestOptions = {\r\n      method: \"PUT\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        data: {\r\n          balance: newBalance,\r\n          transaction: [activity, ...currentLogin.attributes.transaction],\r\n        },\r\n      }),\r\n    };\r\n\r\n    fetch(\r\n      `http://localhost:1337/api/accounts/${currentLogin.id}`,\r\n      requestOptions\r\n    )\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setCurrentLogin(data.data);\r\n        setTriggerFetched((prevState) => !prevState);\r\n      });\r\n  };\r\n\r\n  const authContext = {\r\n    users: accounts,\r\n    isLoggedIn: isLoggedIn,\r\n    currentLogin: currentLogin,\r\n    onLogout: logoutHandler,\r\n    onLogin: loginHandler,\r\n    onSignup: signupHandler,\r\n    onDeposit: deposit,\r\n    onWithdrawal: withdrawal,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={authContext}>\r\n      {props.children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthProvider;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}